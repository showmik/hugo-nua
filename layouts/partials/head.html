<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo {{ hugo.Version }}">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="{{ "mstile-150x150.png" | relURL }}">
<meta name="theme-color" content="#ffffff">

{{/* --- Title & Description (single source of truth) --- */}}
{{- $isArticle := .IsPage -}}
{{- $title := cond .IsHome .Site.Title (printf "%s | %s" .Title .Site.Title) -}}
{{- $ogtitle := cond .IsHome .Site.Title .Title -}}
{{- $desc := "" -}}
{{- if $isArticle -}}
  {{- $desc = or .Description .Summary .Site.Params.description "Explore my thoughts and ideas across various topics—all collected in one place." -}}
{{- else if eq .Kind "taxonomy" -}}
  {{- $desc = printf "All posts tagged under '%s'. Discover related content here." .Title -}}
{{- else if eq .Kind "taxonomyTerm" -}}
  {{- $desc = "Explore the various tags and categories of the site." -}}
{{- else -}}
  {{- $desc = or .Description .Site.Params.description "Explore my thoughts and ideas across various topics—all collected in one place." -}}
{{- end -}}

<title>{{ $title }}</title>
<meta name="description" content="{{ $desc }}">

{{/* --- Open Graph / Twitter --- */}}
<meta property="og:site_name" content="{{ .Site.Title | plainify }}">
<meta property="og:type" content="{{ if $isArticle }}article{{ else }}website{{ end }}">
<meta property="og:title" content="{{ $ogtitle | plainify }}">
<meta property="og:description" content="{{ $desc }}">
<meta property="og:url" content="{{ .Permalink }}">
{{- $img := or .Params.image .Site.Params.image -}}
{{- with $img }}<meta property="og:image" content="{{ . | absURL }}">{{ end -}}

<meta name="twitter:card" content="summary_large_image">
{{- with .Site.Params.twitter_username -}}<meta name="twitter:site" content="@{{ . | replaceRE "^@+" "" }}">{{- end }}
<meta name="twitter:title" content="{{ $ogtitle | plainify }}">
<meta name="twitter:description" content="{{ $desc }}">
{{- with $img }}<meta name="twitter:image" content="{{ . | absURL }}">{{ end -}}

<link rel="canonical" href="{{ .Permalink }}">

{{/* Article times (help readers/search) */}}
{{- if $isArticle -}}
  <meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
  <meta property="article:modified_time"  content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
{{- end -}}

{{/* Theme toggle + themed images */}}
{{ $themeToggleJS := resources.Get "js/theme-toggle.js" | resources.Minify | resources.Fingerprint -}} 
<script src="{{ $themeToggleJS.Permalink }}" integrity="{{ $themeToggleJS.Data.Integrity }}"></script>
{{- $ti := resources.Get "js/themed-images.js" | minify | fingerprint -}}
<script defer src="{{ $ti.RelPermalink }}" integrity="{{ $ti.Data.Integrity }}"></script>

{{- partialCached "json-ld.html" . -}}
{{- partialCached "head/css.html" . -}}
{{- partial "cdn.html" . -}}

{{/* Pagination relations for bots + previews */}}
{{- if .IsNode -}}
  {{- with .Paginator -}}
    {{- with .Prev }}<link rel="prev" href="{{ .URL | absURL }}">{{ end -}}
    {{- with .Next }}<link rel="next" href="{{ .URL | absURL }}">{{ end -}}
  {{- end -}}
{{- else if .IsPage -}}
  {{- with .PrevInSection }}<link rel="prev" href="{{ .Permalink }}">{{ end -}}
  {{- with .NextInSection }}<link rel="next" href="{{ .Permalink }}">{{ end -}}
{{- end -}}
